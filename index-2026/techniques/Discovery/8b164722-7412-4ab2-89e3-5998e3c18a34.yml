name: Bulk Active Directory discovery
description: Discover domain users and groups from Active Directory in bulk
platforms:
- windows
prerequisites:
guidance:
- CMD> adexplorer.exe -> File -> Create snapshot
block:
- ''
detect:
- Windows enumeration activities detected from large amount of network traffic (SMB, ARP, SAMR, etc) via UEBA-like or network monitoring tools
- Enable object logging for directory services via Group Policy Advanced Audit then configure a SACL on Active Directory objects. Trigger an alert when multiple (high-value) objects are accessed by a single source in a short period using object access logs for the directory service objects (Event ID 4656, 4663)
controls:
- SIEM
- Identity Threat Protection
metadata:
  id: 8b164722-7412-4ab2-89e3-5998e3c18a34
  tid: T1087.002
  tactic: TA0007
  x_tools:
  - https://learn.microsoft.com/en-us/sysinternals/downloads/adexplorer
  x_vectr_id: 8b164722-7412-4ab2-89e3-5998e3c18a34
  isv: 1
