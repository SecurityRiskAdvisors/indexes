name: Persist via Registry Run key
description: Run a payload during user login and startup by setting a Registry Run key
platforms:
- windows
prerequisites:
guidance:
- CMD> reg add "HKCU\SOFTWARE\Microsoft\Windows\CurrentVersion\Run" /V "{{ gen_regkey_name }}" /t REG_SZ /F /D "{{ command }}"
block:
- Suspicious process execution/behavior blocked by endpoint security tool
detect:
- Suspicious process execution/behavior detected by endpoint security tool or triggers alert in SIEM based on telemetry
- Enable object logging for the Registry via Group Policy Advanced Audit then configure a SACL on the Registry either directly or via the global audit settings in Group Policy. Trigger an alert when anomalous modifications/access attempts are made using object access logs (e.g. Event IDs 4656, 4657, etc).
controls:
- Endpoint Protection
- SIEM
metadata:
  id: 5dc3f424-8f31-49ee-a822-a77ce20bac43
  tid: T1547.001
  tactic: TA0003
  x_vectr_id: 5dc3f424-8f31-49ee-a822-a77ce20bac43
  isv: 1
